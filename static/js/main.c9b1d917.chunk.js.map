{"version":3,"sources":["TaxiAnimation.js","Taxi.js","App.js","index.js"],"names":["styles","StyleSheet","create","lane","width","background","position","height","React","useState","pos","setPos","taxis","setTaxis","nextTaxi","setNextTaxi","requestRef","useRef","animate","useCallback","time","concat","filter","taxi","Math","log","random","current","requestAnimationFrame","useEffect","cancelAnimationFrame","className","css","map","i","key","role","aria-label","style","right","bottom","container","display","fontSize","fontFamily","fontWeight","fontStyle","borderBottom","overflow","stats","paddingLeft","paddingRight","textAlign","arrivals","avgRate","max","min","length","missTime","t","nextTime","opacity","left","borderLeft","top","toFixed","header","backgroundColor","minHeight","flexDirection","alignItems","justifyContent","color","simHeader","generateArrivals","nextArrival","App","Array","fill","_","taxiArrivals","setTaxiArrivals","missTimes","nextTimes","intervalTimes","TaxiAnimation","margin","Button","onClick","reduce","sum","Taxi","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.c9b1d917.chunk.js","sourcesContent":["import React from \"react\";\nimport {StyleSheet, css} from \"aphrodite\";\n\nconst styles = StyleSheet.create({\n  lane: {\n    width: \"100%\",\n    background: \"#454545\",\n    position: \"relative\",\n    height: 10,\n  },\n});\n\nexport default () => {\n  const [pos, setPos] = React.useState(0);\n  const [taxis, setTaxis] = React.useState([]);\n  const [nextTaxi, setNextTaxi] = React.useState(0);\n\n  const requestRef = React.useRef();\n\n  const animate = React.useCallback(\n    (time) => {\n      setPos(time / 100);\n      if (time > nextTaxi) {\n        // Add a taxi; remove old ones\n        setTaxis(\n          taxis\n            .concat(time / 100 + 10)\n            .filter((taxi) => time / 100 - taxi < 110),\n        );\n        // Compute time of next taxi\n        setNextTaxi(-Math.log(Math.random()) / 0.0005 + time);\n      }\n      requestRef.current = requestAnimationFrame(animate);\n    },\n    [taxis, nextTaxi],\n  );\n\n  React.useEffect(() => {\n    requestRef.current = requestAnimationFrame(animate);\n    return () => cancelAnimationFrame(requestRef.current);\n  }, [animate]);\n\n  return (\n    <div className={css(styles.lane)}>\n      {taxis.map((taxi, i) => (\n        <span\n          key={i}\n          role=\"img\"\n          aria-label=\"taxi\"\n          style={{position: \"absolute\", right: `${pos - taxi}%`, bottom: -7}}\n        >\n          ðŸš•\n        </span>\n      ))}\n    </div>\n  );\n};\n","import React from \"react\";\nimport {StyleSheet, css} from \"aphrodite\";\n\nconst styles = StyleSheet.create({\n  container: {\n    display: \"flex\",\n    fontSize: 12,\n    fontFamily: \"inconsolata\",\n    fontWeight: 500,\n    fontStyle: \"normal\",\n  },\n  lane: {\n    width: \"100%\",\n    position: \"relative\",\n    borderBottom: \"1px solid #eee\",\n    overflow: \"hidden\",\n  },\n  stats: {\n    width: 70,\n    paddingLeft: 5,\n    paddingRight: 20,\n    textAlign: \"right\",\n  },\n});\n\nexport default ({arrivals}) => {\n  const avgRate =\n    (Math.max(...arrivals) - Math.min(...arrivals)) / (arrivals.length - 1);\n\n  const missTime = Math.min(...arrivals.filter((t) => t > 50));\n  const nextTime = Math.max(...arrivals.filter((t) => t <= 50));\n\n  return (\n    <div className={css(styles.container)}>\n      <div className={css(styles.lane)}>\n        {arrivals.map((taxi, i) => (\n          <span\n            key={i}\n            role=\"img\"\n            aria-label=\"taxi\"\n            style={{\n              position: \"absolute\",\n              right: `${taxi}%`,\n              opacity: taxi === missTime || taxi === nextTime ? 1 : 0.4,\n              width: 7,\n            }}\n          >\n            ðŸš•\n          </span>\n        ))}\n        <span\n          // Center line\n          style={{\n            position: \"absolute\",\n            left: \"50%\",\n            borderLeft: \"1px solid #ddd\",\n          }}\n        >\n          &nbsp;\n        </span>\n\n        <span\n          // Left shading\n          style={{\n            position: \"absolute\",\n            right: \"50%\",\n            left: `${100 - missTime}%`,\n            background: \"#558cf4\",\n            opacity: 0.2,\n            bottom: \"40%\",\n            top: \"40%\",\n          }}\n        >\n          &nbsp;\n        </span>\n\n        <span\n          // Right shading\n          style={{\n            position: \"absolute\",\n            left: \"50%\",\n            right: `${nextTime}%`,\n            background: \"#c13c3d\",\n            opacity: 0.2,\n            bottom: \"40%\",\n            top: \"40%\",\n          }}\n        >\n          &nbsp;\n        </span>\n      </div>\n      <div className={css(styles.stats)}>{avgRate.toFixed(3)}</div>\n      <div className={css(styles.stats)}>\n        {(missTime - nextTime).toFixed(3)}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport {Button} from \"react-bootstrap\";\nimport {StyleSheet, css} from \"aphrodite\";\n\nimport TaxiAnimation from \"./TaxiAnimation\";\nimport Taxi from \"./Taxi\";\nimport {relative} from \"path\";\n\nconst styles = StyleSheet.create({\n  header: {\n    backgroundColor: \"#282c34\",\n    minHeight: \"10vh\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    fontSize: \"calc(10px + 2vmin)\",\n    color: \"white\",\n    overflow: \"hidden\",\n  },\n  simHeader: {\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    fontSize: 12,\n    fontFamily: \"inconsolata\",\n    fontWeight: 500,\n    fontStyle: \"normal\",\n  },\n  stats: {\n    width: 70,\n    paddingLeft: 5,\n    paddingRight: 20,\n    textAlign: \"right\",\n  },\n});\n\nconst generateArrivals = (arrivals) => {\n  const lastArrival = Math.max(-100, ...arrivals);\n\n  const nextArrival = lastArrival + -Math.log(Math.random()) / 0.1;\n\n  if (nextArrival > 100 && arrivals.length) {\n    return arrivals.concat(nextArrival);\n  } else {\n    return generateArrivals(arrivals.concat(nextArrival));\n  }\n};\n\nfunction App() {\n  const [taxiArrivals, setTaxiArrivals] = React.useState(\n    Array(10)\n      .fill()\n      .map((_) => generateArrivals([])),\n  );\n\n  const missTimes = taxiArrivals.map(\n    (arrivals) => Math.min(...arrivals.filter((t) => t > 50)) - 50,\n  );\n  const nextTimes = taxiArrivals.map(\n    (arrivals) => 50 - Math.max(...arrivals.filter((t) => t <= 50)),\n  );\n  const intervalTimes = taxiArrivals.map(\n    (arrivals) =>\n      Math.min(...arrivals.filter((t) => t > 50)) -\n      Math.max(...arrivals.filter((t) => t <= 50)),\n  );\n\n  return (\n    <div>\n      <header className={css(styles.header)}>\n        <span role=\"img\" aria-label=\"person\">\n          ðŸ™‹\n        </span>{\" \"}\n        <TaxiAnimation />\n      </header>\n      <div className=\"container\">\n        <div className=\"row\">\n          <div className=\"col-3\">\n            <p style={{margin: 20}}>\n              <Button\n                onClick={() => {\n                  setTaxiArrivals(\n                    Array(100)\n                      .fill()\n                      .map((_) => generateArrivals([])),\n                  );\n                }}\n              >\n                Simulate 100\n              </Button>\n            </p>\n            <p style={{margin: 20}}>\n              <Button\n                onClick={() => {\n                  setTaxiArrivals(\n                    Array(1000)\n                      .fill()\n                      .map((_) => generateArrivals([])),\n                  );\n                }}\n              >\n                Simulate 1000\n              </Button>\n            </p>\n          </div>\n\n          <div className=\"col-9\">\n            <table style={{margin: 20}}>\n              <tbody>\n                <tr>\n                  <td>Average wait time:</td>\n                  <td style={{color: \"#c13c3d\"}}>\n                    {(\n                      nextTimes.reduce((sum, t) => sum + t, 0) /\n                      missTimes.length\n                    ).toFixed(3)}\n                  </td>\n                </tr>\n                <tr>\n                  <td>Average miss time:</td>\n                  <td style={{color: \"#558cf4\"}}>\n                    {(\n                      missTimes.reduce((sum, t) => sum + t, 0) /\n                      missTimes.length\n                    ).toFixed(3)}\n                  </td>\n                </tr>\n                <tr>\n                  <td>Average inter-arrival time:</td>\n                  <td>\n                    {(\n                      taxiArrivals\n                        .map(\n                          (arrivals) =>\n                            (Math.max(...arrivals) - Math.min(...arrivals)) /\n                            (arrivals.length - 1),\n                        )\n                        .reduce((sum, t) => sum + t, 0) / taxiArrivals.length\n                    ).toFixed(3)}\n                  </td>\n                </tr>\n                <tr>\n                  <td width={220}>Average interval while waiting:</td>\n                  <td>\n                    {(\n                      intervalTimes.reduce((sum, t) => sum + t, 0) /\n                      intervalTimes.length\n                    ).toFixed(3)}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n      <div className={css(styles.simHeader)}>\n        <div></div>\n        <div className={css(styles.stats)}>Avg interval</div>\n        <div className={css(styles.stats)}>My interval</div>\n      </div>\n      {taxiArrivals.map((arrivals, i) => (\n        <Taxi key={i} arrivals={arrivals} />\n      ))}\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}